<?xml version="1.0" encoding="utf-8"?>
<project name="Release_build" default="deploy-all">

	<property name="home" value="${ant.file.Release_build}/../" />

	<property name="jboss.home" value="${home}/@JBOSS.PATH@/" />
	<property name="jboss.config" value="@JBOSS.CONFIG@" />
	<property name="jnpHost" value="127.0.0.1" />
	<property name="jnpPort" value="1099" />


	<!-- no JMX deployment? since it works only for JSLEE comps. -->
	<!--
	<target name="deploy-all-jmx">
		<ant antfile="${home}../../resources/mgcp/build.xml" target="deploy-jmx" inheritAll="false">
			<property name="jboss.home" value="${jboss.home}" />
			<property name="node" value="${jboss.config}" />
			<property name="jnpHost" value="${jnpHost}" />
			<property name="jnpPort" value="${jnpPort}" />
		</ant>
		<ant antfile="${home}../../resources/sip/build.xml" target="deploy-jmx" inheritAll="false">
			<property name="jboss.home" value="${jboss.home}" />
			<property name="node" value="${jboss.config}" />
			<property name="jnpHost" value="${jnpHost}" />
			<property name="jnpPort" value="${jnpPort}" />
		</ant>
		<ant antfile="${home}../../examples/converged-demo/du-management.xml" target="deploy-jmx" inheritAll="false">
			<property name="jboss.home" value="${jboss.home}" />
			<property name="node" value="${jboss.config}" />
			<property name="jnpHost" value="${jnpHost}" />
			<property name="jnpPort" value="${jnpPort}" />
		</ant>
	</target>

	<target name="undeploy-all-jmx">
		<ant antfile="${home}../../examples/converged-demo/du-management.xml" target="undeploy-jmx" inheritAll="false">
			<property name="jboss.home" value="${jboss.home}" />
			<property name="node" value="${jboss.config}" />
			<property name="jnpHost" value="${jnpHost}" />
			<property name="jnpPort" value="${jnpPort}" />
		</ant>
		<ant antfile="${home}../../resources/mgcp/build.xml" target="undeploy-jmx" inheritAll="false">
			<property name="jboss.home" value="${jboss.home}" />
			<property name="node" value="${jboss.config}" />
			<property name="jnpHost" value="${jnpHost}" />
			<property name="jnpPort" value="${jnpPort}" />
		</ant>
		<ant antfile="${home}../../resources/sip/build.xml" target="undeploy-jmx" inheritAll="false">
			<property name="jboss.home" value="${jboss.home}" />
			<property name="node" value="${jboss.config}" />
			<property name="jnpHost" value="${jnpHost}" />
			<property name="jnpPort" value="${jnpPort}" />
		</ant>
	</target>
	-->
	<target name="deploy-all">
		<ant antfile="${home}../../resources/mgcp/build.xml" target="deploy" inheritAll="false">
			<property name="jboss.home" value="${jboss.home}" />
			<property name="node" value="${jboss.config}" />
		</ant>
		<ant antfile="${home}../../resources/sip11/build.xml" target="deploy" inheritAll="false">
			<property name="jboss.home" value="${jboss.home}" />
			<property name="node" value="${jboss.config}" />
		</ant>


		<!-- even classes jar -->
		<copy overwrite="true" file="${home}../../examples/converged-demo/converged-demo-custom-events-jar.jar" todir="${jboss.home}/server/${jboss.config}/deploy" />

		<!-- PU POJOs and DS -->
		<copy overwrite="true" verbose="true" file="${home}../../examples/converged-demo/ShoppingDemo-dev-ds.xml" toDir="${jboss.home}/server/${jboss.config}/deploy" />
		<copy overwrite="true" file="${home}../../examples/converged-demo/converged-demo-pojo-pu.jar" todir="${jboss.home}/server/${jboss.config}/deploy" />

		<!-- EAR -->
		<copy overwrite="true" file="${home}../../examples/converged-demo/ShoppingDemo.ear" toDir="${jboss.home}/server/${jboss.config}/deploy" />



		<ant antfile="${home}../../examples/converged-demo/du-management.xml" target="deploy" inheritAll="false">
			<property name="jboss.home" value="${jboss.home}" />
			<property name="node" value="${jboss.config}" />
		</ant>
	</target>

	<target name="undeploy-all">
		<ant antfile="${home}../../examples/converged-demo/du-management.xml" target="undeploy" inheritAll="false">
			<property name="jboss.home" value="${jboss.home}" />
			<property name="node" value="${jboss.config}" />
		</ant>
		
		<ant antfile="${home}../../resources/mgcp/build.xml" target="undeploy" inheritAll="false">
			<property name="jboss.home" value="${jboss.home}" />
			<property name="node" value="${jboss.config}" />
		</ant>

		<ant antfile="${home}../../resources/sip11/build.xml" target="undeploy" inheritAll="false">
			<property name="jboss.home" value="${jboss.home}" />
			<property name="node" value="${jboss.config}" />
		</ant>

		<delete file="${jboss.home}/server/${jboss.config}/deploy/converged-demo-custom-events-jar.jar"/>

		<sleep seconds="10"/>
		<delete file="${jboss.home}/server/${jboss.config}/deploy/ShoppingDemo.ear"/>
		<sleep seconds="10"/>
		<delete file="${jboss.home}/server/${jboss.config}/deploy/converged-demo-pojo-pu.jar"/>
		<sleep seconds="3"/>
		<delete file="${jboss.home}/server/${jboss.config}/deploy/ShoppingDemo-dev-ds.xml"/>
	</target>

</project>
